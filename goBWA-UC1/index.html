
<!doctype html>

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>goBWA - Use Case 1</title>
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://storage.googleapis.com/codelab-elements/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  <google-codelab-analytics gaid="UA-49880327-14"></google-codelab-analytics>
  <google-codelab codelab-gaid=""
                  id="goBWA-UC1"
                  title="goBWA - Use Case 1"
                  environment="web"
                  feedback-link="mailto:ryanlow.sg@gmail.com">
    
      <google-codelab-step label="goBWA - Use Case 1" duration="0">
        <h2 class="checklist" is-upgraded>What you&#39;ll learn</h2>
<ul class="checklist">
<li>Microsoft Forms - form creation</li>
<li>Sharepoint - list creation</li>
<li>Power Automate - automated flow</li>
</ul>
<h2 is-upgraded>Scenario</h2>
<ol type="1" start="1">
<li>Create a form in Microsoft Forms about commute to work</li>
<li>Create an Excel file in OneDrive to store the form responses</li>
<li>Create a Sharepoint List to store the form responses</li>
<li>When a new form response is submitted:</li>
</ol>
<ul>
<li>save the response to the Excel file and the Sharepoint List</li>
<li>send an acknowledgement email to the respondent</li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="Microsoft Forms - form creation" duration="0">
        <h2 is-upgraded>References</h2>
<ul>
<li><a href="https://support.microsoft.com/en-us/office/create-a-form-with-microsoft-forms-4ffb64cc-7d5d-402f-b82e-b1d49418fd9d" target="_blank">Create a form with Microsoft Forms</a></li>
<li><a href="https://helpdeskgeek.com/how-to/how-to-use-microsoft-forms/" target="_blank">How to Use Microsoft Forms</a></li>
<li><a href="https://techcommunity.microsoft.com/t5/microsoft-forms/difference-between-a-form-and-a-quiz/m-p/83278" target="_blank">Difference between form and quiz</a> </li>
</ul>
<h2 is-upgraded>Form to be created</h2>
<p class="image-container"><img style="width: 1103.32px" src="img/cfdcaa56e2ef424c.png"></p>
<h2 is-upgraded>Form creation</h2>
<ol type="1" start="1">
<li>Log in to <a href="https://forms.office.com/" target="_blank">Microsoft Forms</a></li>
<li>Create a new form <code>Commute to work survey</code></li>
</ol>
<p class="image-container"><img style="width: 1103.32px" src="img/861d0c86907ca410.png"></p>
<aside class="special"><p><strong>Question types</strong></p>
<p class="image-container"><img style="width: 1089.00px" src="img/6124080b2a555900.png"></p>
</aside>
<h2 is-upgraded>Section and question creation</h2>
<ol type="1" start="3">
<li>Create all sections and questions</li>
</ol>
<table>
<tr><td colspan="1" rowspan="1"><p>Section 1</p>
</td><td colspan="1" rowspan="1"><p><code>Transportation Information</code></p>
</td><td colspan="1" rowspan="1"><p><code>Choose the transportation mode(s) that you use for the bulk of your commute to work</code></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>Question 1</p>
<p>Choice</p>
<p>Required</p>
</td><td colspan="1" rowspan="1"><p><code>Transportation Type</code></p>
</td><td colspan="1" rowspan="1"><p><code>Public</code></p>
<p><code>Personal</code></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>Question 2</p>
<p>Choice</p>
<p>Multiple answers</p>
<p>Required</p>
</td><td colspan="1" rowspan="1"><p><code>Which mode(s) of transportation do you use?</code></p>
</td><td colspan="1" rowspan="1"><p><code>MRT</code></p>
<p><code>Bus</code></p>
<p><code>Car</code></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>Question 3</p>
<p>Choice</p>
<p>Multiple answers</p>
<p>Required</p>
</td><td colspan="1" rowspan="1"><p><code>Which mode(s) of transportation do you use?</code></p>
</td><td colspan="1" rowspan="1"><p><code>Car</code></p>
<p><code>Walk</code></p>
<p><code>Bicycle</code></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>Section 2</p>
</td><td colspan="1" rowspan="1"><p><code>Commute information</code></p>
</td><td colspan="1" rowspan="1"></td></tr>
<tr><td colspan="1" rowspan="1"><p>Question 4</p>
<p>Text</p>
<p>Restrictions</p>
<p>Less than 360</p>
</td><td colspan="1" rowspan="1"><p><code>Total commute time in minutes</code></p>
</td><td colspan="1" rowspan="1"></td></tr>
<tr><td colspan="1" rowspan="1"><p>Question 5</p>
<p>Rating</p>
<p>Levels 5</p>
<p>Symbol Star</p>
</td><td colspan="1" rowspan="1"><p><code>Rate your commute experience</code></p>
</td><td colspan="1" rowspan="1"></td></tr>
</table>
<h2 is-upgraded>Branching</h2>
<ol type="1" start="4">
<li>In Question 1, click on the ellipses and select <code>Add branching</code>. </li>
</ol>
<p class="image-container"><img style="width: 1103.32px" src="img/1b51d6b892f25b62.png"></p>
<ol type="1" start="5">
<li>Configure branching.</li>
</ol>
<p class="image-container"><img style="width: 1103.32px" src="img/74d0c31b89539e2a.png"></p>
<h2 is-upgraded>Form URL</h2>
<ol type="1" start="6">
<li>Click <code>Share</code> and <code>Copy</code> to copy the URL to the form, which will be used when we want to submit a response to this form.</li>
</ol>
<p class="image-container"><img style="width: 1103.32px" src="img/d5e010906830de0a.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="Microsoft Excel - form response file" duration="0">
        <ol type="1" start="1">
<li>Create an <a href="https://ryanlow-rp.github.io/resources/goBWA/Commute%20survey%20responses.xlsx" target="_blank">Excel document</a> <code>Commute survey responses.xlsx</code> with the following headings</li>
</ol>
<pre>Response ID
Response DateTime
Responder Email
Responder Name
Transportation Type
Transportation Modes
Commute Time
Commute Experience</pre>
<p class="image-container"><img style="width: 1103.32px" src="img/e6a58436debe9131.png"></p>
<ol type="1" start="2">
<li>Click <code>Format as Table</code> and select a table style.</li>
</ol>
<p class="image-container"><img style="width: 1103.32px" src="img/9f964a3812f652b1.png"></p>
<ol type="1" start="3">
<li>Confirm the range of cells for the table and check <code>My table has headers</code></li>
</ol>
<p class="image-container"><img style="width: 1103.32px" src="img/52983ca4ff29b5bd.png"></p>
<ol type="1" start="4">
<li>The table should have the default name of <code>Table1</code></li>
</ol>
<p class="image-container"><img style="width: 1103.32px" src="img/8eef2936137109c3.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="OneDrive - upload Excel document" duration="0">
        <ol type="1" start="1">
<li>Upload the Excel document to your OneDrive folder. For this guide, we will assume that you have a folder called <code>goBWA</code> in the root of your OneDrive and the file is uploaded to <code>/goBWA/Commute survey responses.xlsx</code></li>
</ol>
<p class="image-container"><img style="width: 1103.32px" src="img/64f98603157b70c8.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="Power Automate - Automated Cloud Flow" duration="0">
        <aside class="special"><p><strong>Power Automate concepts</strong></p>
<ul>
<li>Every flow has two main parts: a trigger, and one or more actions.</li>
<li>You can think of the trigger as the starting action for the flow. The trigger can be something like a new email arriving in your inbox or a new item being added to a SharePoint list.</li>
<li>Actions are what you want to happen when a trigger is invoked. For example, the new email trigger will start the action of creating a new file on OneDrive for Business. Other examples of actions include sending an email, posting a tweet, and starting an approval.</li>
</ul>
</aside>
<ol type="1" start="1">
<li>Log in to <a href="https://asia.flow.microsoft.com/en-us/" target="_blank">Power Automate</a></li>
<li>Click <code>My flows</code>, <code>Automated cloud flow</code></li>
</ol>
<p class="image-container"><img style="width: 1103.32px" src="img/7fdbc565190807d9.png"></p>
<h2 is-upgraded>Selecting a trigger for the flow</h2>
<ol type="1" start="3">
<li>Create flow <code>Commute survey response submitted</code> with the trigger <code>When a new response is submitted Microsoft Forms</code></li>
</ol>
<p class="image-container"><img style="width: 1103.32px" src="img/d495e4ed06b9e67a.png"></p>
<ol type="1" start="4">
<li>Select the form from the dropdown list.</li>
</ol>
<p class="image-container"><img style="width: 1103.32px" src="img/a8ecd836d6ae5bda.png"></p>
<ol type="1" start="5">
<li>Click <code>New step</code> to add a new action to the end of the flow.</li>
</ol>
<p class="image-container"><img style="width: 1103.32px" src="img/beab543a085aa970.png"></p>
<h2 is-upgraded>Getting response details from a Microsoft Form</h2>
<ol type="1" start="6">
<li>Search for and select <code>Get response details Microsoft Forms</code></li>
</ol>
<p class="image-container"><img style="width: 1103.32px" src="img/fddf37973b06e33d.png"></p>
<ol type="1" start="7">
<li>For the <code>Form Id</code>, select the form from the dropdown list. For the <code>Response Id</code>, select <code>Response Id</code> from the Dynamic content list.</li>
</ol>
<p class="image-container"><img style="width: 1103.32px" src="img/df3f8a1276f081a.png"></p>
<aside class="special"><p><a href="https://blog.enterprisedna.co/power-automate-dynamic-content-overview/" target="_blank"><strong>Dynamic content</strong></a></p>
<p>Dynamic content are variables produced by triggers and actions within a flow diagram.</p>
<p>Each action generates its own set of Dynamic content.</p>
<p>To make it easier to distinguish between the different actions, rename every action to something meaningful. The <code>Rename</code> option can be accessed by clicking on the ellipses for that action.</p>
</aside>
<h2 is-upgraded>Adding a row to an Excel Online (Business) file</h2>
<ol type="1" start="8">
<li>Search for and select <code>Add a row into a table Excel Online (Business)</code></li>
</ol>
<p class="image-container"><img style="width: 1103.32px" src="img/b40b3d2c9f1e0b5.png"></p>
<ol type="1" start="9">
<li>Fill in the first 4 fields for the OneDrive file in <code>/goBWA/Commute survey responses.xlsx</code>. For the remaining fields, select from the Dynamic content list.</li>
</ol>
<p class="image-container"><img style="width: 1103.32px" src="img/f00bdff61ce29c9.png"></p>
<table>
<tr><td colspan="1" rowspan="1"><p><strong>Field</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>Action</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>Dynamic content</strong></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>Response ID</p>
</td><td colspan="1" rowspan="1"><p>When a new response is submitted</p>
</td><td colspan="1" rowspan="1"><p>Response ID</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>Response DateTime</p>
</td><td colspan="1" rowspan="1"><p>Get response details</p>
</td><td colspan="1" rowspan="1"><p>Submission time</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>Responder Email</p>
</td><td colspan="1" rowspan="1"><p>Get response details</p>
</td><td colspan="1" rowspan="1"><p>Responders&#39; Email</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>Transportation Type</p>
</td><td colspan="1" rowspan="1"><p>Get response details</p>
</td><td colspan="1" rowspan="1"><p>Transportation Type</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>Transportation Modes</p>
</td><td colspan="1" rowspan="1"><p>Get response details</p>
</td><td colspan="1" rowspan="1"><p>Which mode(s) of transportation do you use?</p>
<p>Which mode(s) of transportation do you use?</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>Commute Time</p>
</td><td colspan="1" rowspan="1"><p>Get response details</p>
</td><td colspan="1" rowspan="1"><p>Total commute time in minutes</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>Commute Experience</p>
</td><td colspan="1" rowspan="1"><p>Get response details</p>
</td><td colspan="1" rowspan="1"><p>Rate your commute experience</p>
</td></tr>
</table>
<aside class="special"><p><strong>Notes</strong></p>
<ol type="1" start="1">
<li>Response details show the question titles as well as the section titles.</li>
<li>In the form, question 2 and 3 have the same title. From the dynamic content list, there is no way to tell which response is for question 2 or question 3.</li>
<li>Multiple pieces of dynamic content can be used to populate a single excel field, as is the case for the field Transportation Mode.</li>
<li>Leave the Responder Name field empty for now, we will fix this shortly.</li>
</ol>
<p><strong>Best practice</strong></p>
<ol type="1" start="1">
<li>In a Microsoft Form, keep all section titles and question titles distinct for easy identification in Power Automate.</li>
</ol>
</aside>
<ol type="1" start="10">
<li>In the top right hand corner, click <code>Save</code>, then <code>Flow checker</code> to ensure there are no errors, then <code>Test</code>. Select the <code>Manually</code> option, which has the instruction <em>Submit a new response to the selected form to trigger it.</em></li>
</ol>
<p class="image-container"><img style="width: 1103.32px" src="img/611001acfc0befe5.png"></p>
<ol type="1" start="11">
<li>Access the form from the form URL and submit a response. Check the excel file in OneDrive.</li>
</ol>
<p class="image-container"><img style="width: 1103.32px" src="img/35fdfb04a0d30b3f.png"></p>
<h2 is-upgraded>Accessing Office 365 Users information</h2>
<ol type="1" start="12">
<li>Click on the + between <code>Get response details</code> and <code>Add a row into a table</code></li>
</ol>
<p class="image-container"><img style="width: 1103.32px" src="img/f860921fcabe8554.png"></p>
<ol type="1" start="13">
<li>Search for and select <code>Get user profile (V2) Office 365 Users</code></li>
</ol>
<p class="image-container"><img style="width: 1103.32px" src="img/b500943fa79b827.png"></p>
<ol type="1" start="14">
<li>For the <code>User (UPN)</code> use the <code>Responders' Email</code> from <code>Get response details</code>.</li>
</ol>
<p class="image-container"><img style="width: 1103.32px" src="img/765daabc597b5b82.png"></p>
<ol type="1" start="15">
<li>In the <code>Add a row into a table</code> action, for the <code>Responder Name</code> use the <code>Display Name</code> from <code>Get user profile (V2)</code>.</li>
</ol>
<p class="image-container"><img style="width: 1103.32px" src="img/5a24ee1e86db8deb.png"></p>
<ol type="1" start="16">
<li>Access the form from the form URL and submit a response. Check the excel file in OneDrive.</li>
</ol>
<p class="image-container"><img style="width: 1103.32px" src="img/77779d8832bdde67.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="Sharepoint - create list from Excel" duration="0">
        <ol type="1" start="1">
<li>Using the <code>App Launcher</code>, launch <code>Lists</code>. If not shown in the list of Apps, click on <code>All apps</code> to see it.</li>
</ol>
<p class="image-container"><img style="width: 1103.32px" src="img/f4d7aa5d943e3f1b.png"></p>
<ol type="1" start="2">
<li>Click <code>New list</code></li>
</ol>
<p class="image-container"><img style="width: 1103.32px" src="img/a72e98e44134d733.png"></p>
<ol type="1" start="3">
<li>Click <code>From Excel</code></li>
</ol>
<p class="image-container"><img style="width: 1103.32px" src="img/f800f579fcd30d39.png"></p>
<ol type="1" start="4">
<li>Browse to the OneDrive file at <code>/goBWA/Commute survey responses.xlsx</code>. Select the file and click <code>Next</code>.</li>
</ol>
<p class="image-container"><img style="width: 1103.32px" src="img/7106f03522506f9c.png"></p>
<ol type="1" start="5">
<li>For the <code>Response DateTime</code>, change the type to <code>Date and time</code>. For the <code>Commute Time</code> and <code>Commute Experience</code>, change the type to <code>Single line of text</code>.</li>
</ol>
<p class="image-container"><img style="width: 1103.32px" src="img/88ce526a010385f9.png"></p>
<aside class="special"><p><strong>Notes</strong></p>
<ol type="1" start="1">
<li>The <code>ResponseID</code> is mapped to <code>Title</code>. For every Sharepoint List, exactly one column must be identified as <code>Title</code>.</li>
<li>When creating a Sharepoint List from an Excel file, the Excel file must minimally contain the header row and one row of data.</li>
</ol>
</aside>
<ol type="1" start="6">
<li>Create the list as <code>Commute survey responses</code></li>
</ol>
<p class="image-container"><img style="width: 1103.32px" src="img/af278406e14916a9.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="Power Automate - Automated Cloud Flow (continued)" duration="0">
        <h2 is-upgraded>Creating an item in a Sharepoint List</h2>
<ol type="1" start="1">
<li>Click <code>New step</code> to add a new action to the end of the flow. Search for and select <code>Create Item SharePoint</code></li>
</ol>
<p class="image-container"><img style="width: 1103.32px" src="img/df7f7525304fe2e5.png"></p>
<ol type="1" start="2">
<li>For the <code>Site Address</code>, enter the URL of your Sharepoint List. You may see a message <em>The SharePoint site address has automatically been trimmed to the correct url</em>. For the <code>List Name</code>, select <code>Commute survey responses</code>. For the remaining fields, select from the Dynamic content list as before.</li>
</ol>
<p class="image-container"><img style="width: 1103.32px" src="img/74d52b992ab7fda.png"></p>
<aside class="special"><p><strong>Notes</strong></p>
<ol type="1" start="1">
<li>Notice that Dynamic content from the <code>Add a row into a table</code> action is available and similarly named. For this example, the dynamic content from that action can be used as well. Understand what content is actually in the dynamic content for each action and choose carefully and wisely.</li>
</ol>
</aside>
<ol type="1" start="3">
<li>Access the form from the form URL and submit a response. Check the SharePoint list.</li>
</ol>
<p class="image-container"><img style="width: 1103.32px" src="img/54db3f68f3aaa931.png"></p>
<h2 is-upgraded>Sending an email</h2>
<ol type="1" start="4">
<li>Click <code>New step</code> to add a new action to the end of the flow. Search for and select <code>Send an email (V2) Office 365 Outlook</code></li>
</ol>
<p class="image-container"><img style="width: 1103.32px" src="img/cf71b3b6a3c48309.png"></p>
<ol type="1" start="5">
<li>Enter the information for the fields.</li>
</ol>
<p class="image-container"><img style="width: 1103.32px" src="img/28d8cf65b2727563.png"></p>
<table>
<tr><td colspan="1" rowspan="1"><p><strong>Field</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>Value</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>Comments</strong></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>To</p>
</td><td colspan="1" rowspan="1"><p><code>Responder Email</code></p>
</td><td colspan="1" rowspan="1"><p>Dynamic content</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>Subject</p>
</td><td colspan="1" rowspan="1"><p>Commute to work survey response received</p>
</td><td colspan="1" rowspan="1"><p>Hardcoded literal value</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>Body</p>
</td><td colspan="1" rowspan="1"><p>Dear <code>Display Name</code></p>
<p>Thank you for your survey response.</p>
</td><td colspan="1" rowspan="1"><p>Mixture of hardcoded literal value and dynamic content</p>
</td></tr>
</table>
<ol type="1" start="6">
<li>Access the form from the form URL and submit a response. Check your mailbox.</li>
</ol>


      </google-codelab-step>
    
  </google-codelab>

  <script src="https://storage.googleapis.com/codelab-elements/native-shim.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/custom-elements.min.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/prettify.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/codelab-elements.js"></script>
  <script src="//support.google.com/inapp/api.js"></script>

</body>
</html>
